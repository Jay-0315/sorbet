<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <title>10연 뽑기 결과</title>
  <link rel="stylesheet" th:href="@{/css/gatcha-result.css}" />
  <style>
    /* Layout */
    .multi-gatcha-container{ text-align:center; padding:40px; }
    .card-grid{
      display:flex; flex-wrap:wrap; justify-content:center;
      gap:20px; margin-top:30px;
    }

    /* Flip Card (10연 전용 사이즈) */
    .card-flip{
      perspective:1000px;
      width:150px; height:220px;
      cursor:pointer; position:relative; isolation:isolate; /* glow 레이어 분리 */
      flex:0 0 auto;
    }
    .card-inner{
      position:relative; width:100%; height:100%;
      transform-style:preserve-3d; transition:transform .8s;
    }
    .card-flip.flipped .card-inner{ transform: rotateY(180deg); }

    .card-front,.card-back{
      position:absolute; inset:0;
      width:100%; height:100%;
      border-radius:12px; backface-visibility:hidden; overflow:hidden;
      box-shadow:0 4px 10px rgba(0,0,0,.1);
    }
    .card-front{ background:url('/images/cardback.png') center/cover no-repeat; }
    .card-back{
      background:#fff; transform:rotateY(180deg);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      padding:10px; box-sizing:border-box; text-align:center;
    }

    .card-back img{ width:80px; height:auto; margin-bottom:6px; border-radius:10px; }
    .card-back p{ margin:4px 0; font-size:.9em; font-weight:bold; color:#e9643b; }

    /* Buttons */
    .btn-box{ margin-top:40px; }
    .btn-box a{
      margin:0 10px; padding:10px 20px; border-radius:10px;
      background:#ffb74d; color:#fff; text-decoration:none; transition:.3s;
      box-shadow:0 2px 6px rgba(0,0,0,.12);
    }
    .btn-box a:hover{ background:#ffa726; transform:scale(1.05); }

    /* ===== 등급별 오오라 & 이미지 글로우 ===== */
    /* 카드 뒤 오오라: SSR */
    .card-flip.grade-SSR::before{
      content:""; position:absolute; inset:-10px; border-radius:16px; z-index:-1;
      background:
              radial-gradient(60% 60% at 50% 40%, rgba(255,215,0,.55), transparent 60%),
              radial-gradient(70% 70% at 50% 60%, rgba(255,196,0,.35), transparent 70%),
              conic-gradient(from 0deg, rgba(255,230,120,.5), rgba(255,210,20,.6), rgba(255,230,120,.5));
      filter:blur(10px); animation:auraPulse 2.2s ease-in-out infinite alternate;
    }
    /* 카드 뒤 오오라: SR */
    .card-flip.grade-SR::before{
      content:""; position:absolute; inset:-10px; border-radius:16px; z-index:-1;
      background:
              radial-gradient(60% 60% at 50% 40%, rgba(186,85,211,.55), transparent 60%),
              radial-gradient(70% 70% at 50% 60%, rgba(150,90,255,.35), transparent 70%),
              conic-gradient(from 0deg, rgba(210,160,255,.5), rgba(150,90,255,.6), rgba(210,160,255,.5));
      filter:blur(10px); animation:auraPulse 2.2s ease-in-out infinite alternate;
    }

    /* 이미지 글로우 */
    .card-flip.grade-SSR .card-back img{
      box-shadow:
              0 0 12px rgba(255,215,0,.65),
              0 0 24px rgba(255,200,0,.45),
              0 0 36px rgba(255,180,0,.35);
      animation: imgGlow 1.8s ease-in-out infinite alternate;
    }
    .card-flip.grade-SR .card-back img{
      box-shadow:
              0 0 12px rgba(186,85,211,.65),
              0 0 24px rgba(150,90,255,.45),
              0 0 36px rgba(120,70,220,.35);
      animation: imgGlow 1.8s ease-in-out infinite alternate;
    }

    /* Animations */
    @keyframes auraPulse{
      0%{ filter:blur(9px) brightness(1.0); transform:scale(.98); }
      100%{ filter:blur(12px) brightness(1.12); transform:scale(1.02); }
    }
    @keyframes imgGlow{
      0%{ filter:brightness(1.0) saturate(1.0); }
      100%{ filter:brightness(1.12) saturate(1.08); }
    }
    @media (prefers-reduced-motion: reduce){
      .card-flip::before, .card-back img{ animation:none !important; }
    }
  </style>
</head>
<body>
<div class="multi-gatcha-container">
  <h1 class="use-crayon-font">10연 뽑기 결과 🎉</h1>

  <div class="card-grid">
    <!-- 🔑 등급 클래스를 .card-flip에 붙입니다 -->
    <div th:each="item : ${results}"
         class="card-flip"
         th:classappend="' grade-' + ${item.grade}"
         onclick="this.classList.toggle('flipped')">
      <div class="card-inner">
        <div class="card-front"></div>
        <div class="card-back">
          <img th:src="@{${item.imagePath}}" th:alt="${item.displayName}" />
          <p th:text="${item.displayName}"></p>
          <p th:text="'등급 ' + ${item.grade}"></p>
        </div>
      </div>
    </div>
  </div>

  <div class="btn-box">
    <a class="use-crayon-font" href="/gatcha">ONE MORE</a>
    <a class="use-crayon-font" href="/mypage">INVENTORY</a>
  </div>
</div>
</body>
</html>
